#!/usr/bin/env bash

# Check if BUILD_DIR is set, otherwise use PWD
BUILD_DIR=${BUILD_DIR:-$PWD}
echo "BUILD_DIR is set to $BUILD_DIR"

# Set the LD_LIBRARY_PATH
export LD_LIBRARY_PATH=$BUILD_DIR/.apt/usr/lib/x86_64-linux-gnu:$LD_LIBRARY_PATH
echo "LD_LIBRARY_PATH is set to $LD_LIBRARY_PATH"

# Ensure the .apt directory exists
if [ -d "$BUILD_DIR/.apt/usr/lib/x86_64-linux-gnu" ]; then
  echo "Copying libraries to $BUILD_DIR/.heroku/vendor/lib"
  mkdir -p $BUILD_DIR/.heroku/vendor/lib
  cp -r $BUILD_DIR/.apt/usr/lib/x86_64-linux-gnu/* $BUILD_DIR/.heroku/vendor/lib/
else
  echo "Directory $BUILD_DIR/.apt/usr/lib/x86_64-linux-gnu does not exist"
fi